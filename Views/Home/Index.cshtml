@model dynamic
@{
    ViewData["Title"] = "Trang chủ";
}

@functions {
    string GetFirstImage(string? hinhanh)
    {
        if (string.IsNullOrEmpty(hinhanh)) return "/images/no-image.jpg";
        var images = hinhanh.Split(';', StringSplitOptions.RemoveEmptyEntries);
        
        foreach (var img in images)
        {
            var trimmed = img.Trim();
            if (string.IsNullOrEmpty(trimmed)) continue;
            
            if (trimmed.StartsWith("/") || trimmed.StartsWith("http"))
                return trimmed;
            
            if (!trimmed.Contains("/"))
                return "/images/products/" + trimmed;
            
            return "/" + trimmed;
        }
        return "/images/no-image.jpg";
    }
}

<!-- Hero Slider -->
<section class="hero-slider">
    <div class="slide" style="background: linear-gradient(135deg, #8B4513, #D2691E);">
        <div class="slide-content">
            <h1>Không Gian Văn Hóa Nghệ Thuật</h1>
            <p>Khám phá bộ sưu tập đồ trang trí nội thất cao cấp, mang đến vẻ đẹp tinh tế cho ngôi nhà của bạn</p>
            <a href="/san-pham" class="btn btn-secondary">Khám phá ngay</a>
        </div>
    </div>
</section>

<!-- SẢN PHẨM BÁN CHẠY -->
<section class="section" style="background: var(--gray-light);">
    <div class="container">
        <div class="section-title">
            <h2><i class="fas fa-fire" style="color: #dc3545;"></i> Sản phẩm bán chạy</h2>
            <p>Những sản phẩm được khách hàng yêu thích và mua nhiều nhất</p>
        </div>
        <div class="products-grid">
            @if (ViewBag.FeaturedProducts != null)
            {
                foreach (var product in ViewBag.FeaturedProducts)
                {
                    <div class="product-card">
                        <div class="product-image">
                            <img src="@GetFirstImage((string)product.Hinhanh)" alt="@product.Tensp" />
                            <span class="product-badge badge-hot">HOT</span>
                            <div class="product-actions">
                                <a href="/san-pham/@product.Masp" title="Xem chi tiết"><i class="fas fa-eye"></i></a>
                                <a href="#" onclick="addToCart('@product.Masp')" title="Thêm vào giỏ"><i class="fas fa-shopping-cart"></i></a>
                                <a href="#" title="Yêu thích"><i class="fas fa-heart"></i></a>
                            </div>
                        </div>
                        <div class="product-info">
                            <div class="product-category">@(product.ManhomspNavigation?.Tennhomsp ?? "Nội thất")</div>
                            <h3 class="product-name"><a href="/san-pham/@product.Masp">@product.Tensp</a></h3>
                            <div class="product-price">
                                <span class="current-price">@(((decimal?)product.Giaban)?.ToString("N0") ?? "0") ₫</span>
                            </div>
                        </div>
                    </div>
                }
            }
        </div>
        <div class="text-center mt-3">
            <a href="/san-pham-ban-chay" class="btn btn-primary"><i class="fas fa-fire"></i> Xem tất cả sản phẩm bán chạy</a>
        </div>
    </div>
</section>

<!-- SẢN PHẨM GIẢM GIÁ -->
@if (ViewBag.SaleProducts != null && ((IEnumerable<dynamic>)ViewBag.SaleProducts).Any())
{
<section class="section" style="background: linear-gradient(135deg, #dc3545, #fd7e14); padding: 40px 0;">
    <div class="container">
        <div class="section-title" style="color: white;">
            <h2 style="color: white;"><i class="fas fa-tags"></i> Sản phẩm giảm giá</h2>
            <p style="color: rgba(255,255,255,0.9);">Ưu đãi đặc biệt - Tiết kiệm đến 50%</p>
        </div>
        <div class="products-grid">
            @foreach (var product in ViewBag.SaleProducts)
            {
                <div class="product-card">
                    <div class="product-image">
                        <img src="@GetFirstImage((string)product.Hinhanh)" alt="@product.Tensp" />
                        <span class="product-badge badge-sale" style="font-size: 14px; padding: 8px 12px;">-@product.PhanTramGiam%</span>
                        <div class="product-actions">
                            <a href="/san-pham/@product.Masp" title="Xem chi tiết"><i class="fas fa-eye"></i></a>
                            <a href="#" onclick="addToCart('@product.Masp')" title="Thêm vào giỏ"><i class="fas fa-shopping-cart"></i></a>
                            <a href="#" title="Yêu thích"><i class="fas fa-heart"></i></a>
                        </div>
                    </div>
                    <div class="product-info">
                        <div class="product-category">@(product.ManhomspNavigation?.Tennhomsp ?? "Nội thất")</div>
                        <h3 class="product-name"><a href="/san-pham/@product.Masp">@product.Tensp</a></h3>
                        <div class="product-price">
                            <span class="old-price">@(((decimal?)product.GiaGoc)?.ToString("N0") ?? "0") ₫</span>
                            <span class="current-price sale-price">@(((decimal?)product.Giaban)?.ToString("N0") ?? "0") ₫</span>
                        </div>
                        <div style="margin-top: 5px;">
                            <span style="background: #fff3cd; color: #856404; padding: 3px 8px; border-radius: 4px; font-size: 12px;">
                                Tiết kiệm @((((decimal?)product.GiaGoc ?? 0) - ((decimal?)product.Giaban ?? 0)).ToString("N0")) ₫
                            </span>
                        </div>
                    </div>
                </div>
            }
        </div>
        <div class="text-center mt-3">
            <a href="/san-pham-giam-gia" class="btn btn-secondary" style="background: white; color: #dc3545; border: none;"><i class="fas fa-tags"></i> Xem tất cả sản phẩm giảm giá</a>
        </div>
    </div>
</section>
}

<!-- SẢN PHẨM MỚI -->
<section class="section">
    <div class="container">
        <div class="section-title">
            <h2><i class="fas fa-sparkles" style="color: #28a745;"></i> Sản phẩm mới</h2>
            <p>Cập nhật những sản phẩm mới nhất vừa về kho</p>
        </div>
        <div class="products-grid">
            @if (ViewBag.NewProducts != null)
            {
                foreach (var product in ViewBag.NewProducts)
                {
                    <div class="product-card">
                        <div class="product-image">
                            <img src="@GetFirstImage((string)product.Hinhanh)" alt="@product.Tensp" />
                            <span class="product-badge badge-new">NEW</span>
                            <div class="product-actions">
                                <a href="/san-pham/@product.Masp" title="Xem chi tiết"><i class="fas fa-eye"></i></a>
                                <a href="#" onclick="addToCart('@product.Masp')" title="Thêm vào giỏ"><i class="fas fa-shopping-cart"></i></a>
                                <a href="#" title="Yêu thích"><i class="fas fa-heart"></i></a>
                            </div>
                        </div>
                        <div class="product-info">
                            <div class="product-category">@(product.ManhomspNavigation?.Tennhomsp ?? "Nội thất")</div>
                            <h3 class="product-name"><a href="/san-pham/@product.Masp">@product.Tensp</a></h3>
                            <div class="product-price">
                                <span class="current-price">@(((decimal?)product.Giaban)?.ToString("N0") ?? "0") ₫</span>
                            </div>
                        </div>
                    </div>
                }
            }
        </div>
        <div class="text-center mt-3">
            <a href="/san-pham" class="btn btn-primary"><i class="fas fa-th-large"></i> Xem tất cả sản phẩm</a>
        </div>
    </div>
</section>

<!-- About Section -->
<section class="section about-section" style="background: var(--gray-light);">
    <div class="container">
        <div class="about-image">
            <img src="/images/about-home.jpg" alt="Về Nội Thất Việt" />
        </div>
        <div class="about-content">
            <h2>Về Nội Thất Việt</h2>
            <p>Nội Thất Việt là đơn vị chuyên cung cấp các sản phẩm trang trí nội thất cao cấp, đồ decor phong cách hiện đại và quà tặng sang trọng cho mọi không gian sống.</p>
            <p>Với hơn 10 năm kinh nghiệm trong ngành, chúng tôi tự hào mang đến cho khách hàng những sản phẩm chất lượng nhất với giá cả hợp lý nhất.</p>
            <ul class="about-features">
                <li><i class="fas fa-check-circle"></i> Sản phẩm chính hãng 100%</li>
                <li><i class="fas fa-check-circle"></i> Bảo hành dài hạn</li>
                <li><i class="fas fa-check-circle"></i> Giao hàng toàn quốc</li>
                <li><i class="fas fa-check-circle"></i> Đổi trả trong 30 ngày</li>
            </ul>
            <a href="/gioi-thieu" class="btn btn-primary mt-2">Tìm hiểu thêm</a>
        </div>
    </div>
</section>

<!-- Features Bar -->
<section class="features-bar">
    <div class="container">
        <div class="feature-item">
            <i class="fas fa-truck"></i>
            <div>
                <h4>Giao hàng toàn quốc</h4>
                <p>Miễn phí vận chuyển</p>
            </div>
        </div>
        <div class="feature-item">
            <i class="fas fa-headset"></i>
            <div>
                <h4>Uy tín - Chuyên nghiệp</h4>
                <p>Tư vấn, hỗ trợ tận tâm</p>
            </div>
        </div>
        <div class="feature-item">
            <i class="fas fa-certificate"></i>
            <div>
                <h4>Cam kết chất lượng</h4>
                <p>Nhập khẩu chính hãng</p>
            </div>
        </div>
        <div class="feature-item">
            <i class="fas fa-tags"></i>
            <div>
                <h4>Giá rẻ nhất Việt Nam</h4>
                <p>Cam kết rẻ nhất</p>
            </div>
        </div>
    </div>
</section>
